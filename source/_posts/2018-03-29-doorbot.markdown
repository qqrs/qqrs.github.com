---
layout: post
title: "Doorbot"
date: 2018-03-29 00:12
comments: false
categories: code electronics
---

## What is it?

Doorbot is an Internet-connected door unlocker that I built for a community space. It allows people to enter the space without needing to be buzzed in.

{% img center /images/doorbot_flask_app_ready.png Doorbot flask app ready screenshot %}

## System Architecture

<a href="/images/doorbot_block_diagram.png" target="_blank">{% img center /images/doorbot_block_diagram_th.png Doorbot block diagram %}</a>

The Doorbot system consists of:

1. servo motors to actuate the door buzzer button
2. ESP8266 microcontroller with built-in Wi-Fi
3. NodeMCU firmware for ESP8266
4. lua application code for ESP8266
5. MQTT message broker
6. web app with user authentication

The web app sends HMAC-signed command messages to the MQTT broker. The microcontroller waits for command messages to actuate the servo motor and unlock the door.

The microcontroller also sends periodic heartbeat messages so that the web app can show when Doorbot is offline.

## Building a Doorbot

The [bill of materials](https://octopart.com/bom-tool/tx1u0UMp) shows everything purchased to build Doorbot.

[Update 3/3/2019: If I was starting today I'd strongly consider using the Raspberry Pi Zero W instead of the ESP8266.]

To mount Doorbot, I used [90Â° steel angle brackets](https://www.homedepot.com/p/Simpson-Strong-Tie-12-Gauge-Angle-A66/100375146) from Home Depot, [3M 4011 double-sided mounting tape](https://www.homedepot.com/p/3M-Scotch-1-in-x-1-66-yds-Permanent-Double-Sided-Outdoor-Mounting-Tape-411DC-SF/100575385), and [4 inch cable ties](https://www.homedepot.com/p/Commercial-Electric-4-in-Cable-Tie-Natural-1000-Pack-GT-100M/203531927).

## Doorbot Operation

TODO: Doorbot photo  
TODO: Doorbot action gif  

## Suggested Reading

1. <a href="https://www.jameco.com/jameco/workshop/howitworks/how-servo-motors-work.html" target="_blank">https://www.jameco.com/jameco/workshop/howitworks/how-servo-motors-work.html</a>

1. <a href="https://hackaday.com/2014/08/26/new-chip-alert-the-esp8266-wifi-module-its-5/" target="_blank">https://hackaday.com/2014/08/26/new-chip-alert-the-esp8266-wifi-module-its-5/</a>

1. <a href="https://nodemcu.readthedocs.io/en/master/" target="_blank">https://nodemcu.readthedocs.io/en/master/</a>

1. <a href="http://www.hivemq.com/mqtt-security-fundamentals/" target="_blank">http://www.hivemq.com/mqtt-security-fundamentals/</a>

1. <a href="http://www.hivemq.com/blog/mqtt-security-fundamentals-mqtt-message-data-integrity" target="_blank">http://www.hivemq.com/blog/mqtt-security-fundamentals-mqtt-message-data-integrity</a>

[Update 3/3/2019: This [Hackaday post](https://hackaday.com/2017/06/20/practical-iot-cryptography-on-the-espressif-esp8266/) is a practical guide to securing a command protocol for the ESP8266.]
